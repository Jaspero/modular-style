<!DOCTYPE html>
<html>

<head>

    <!-- sass --watch index.scss:index.css --style compressed -->

    <!-- Metas -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Links -->
    <link rel="stylesheet" type="text/css" href="index.css" />

    <!-- Javascript -->
    <script>
        window.onload = () => {

            /*
             * Accordion
             */

            const activeClassName = 'active';
            const accordionClassName = 'accordion';
            const summaryClassName = 'accordion-summary';

            const accordionElements = document.querySelectorAll('.' + accordionClassName);

            function open(accordionEl) {

                const height = accordionEl.scrollHeight;

                accordionEl.style.maxHeight = height + 'px';

                let parent = accordionEl.parentElement;

                while (parent) {

                    if (parent.classList.contains(accordionClassName)) {
                        const currentMaxHeight = parseInt(parent.style.maxHeight.replace('px', ''));
                        parent.style.maxHeight = (currentMaxHeight + height) + 'px';
                    }

                    parent = parent.parentElement;
                }

                accordionEl.classList.add(activeClassName);
            }

            function close(accordionEl, summeryEl) {
                const height = accordionEl.scrollHeight - summeryEl.scrollHeight;

                accordionEl.style.maxHeight = summeryEl.scrollHeight + 'px';

                let parent = accordionEl.parentElement;

                while (parent) {

                    if (parent.classList.contains(accordionClassName)) {
                        const currentMaxHeight = parseInt(parent.style.maxHeight.replace('px', ''));
                        parent.style.maxHeight = (currentMaxHeight - height) + 'px';
                    }

                    parent = parent.parentElement;
                }

                accordionEl.classList.remove(activeClassName);
            }

            accordionElements.forEach(accordionEl => {
                const summeryEl = accordionEl.querySelector('.' + summaryClassName);

                let active = accordionEl.classList.contains(activeClassName);

                if (active) {
                    open(accordionEl);
                } else {
                    close(accordionEl, summeryEl);
                }

                summeryEl.addEventListener('click', () => {
                    if (active) {
                        close(accordionEl, summeryEl);
                    } else {
                        open(accordionEl);
                    }

                    active = !active;
                })
            });

            /*
             * Modal
             */

            const modal = document.querySelectorAll('.modal');
            const modalContent = document.querySelectorAll('.modal-content');
            const modalOpen = document.querySelectorAll('[data-open-modal]');
            const modalClose = document.querySelectorAll('[data-close-modal]');

            modalOpen.forEach(el => {
                const modalEl = document.getElementById(el.getAttribute('data-open-modal'));
                el.addEventListener('click', () => {
                    modalEl.classList.add('active');
                    const modalHeaderEl = modalEl.querySelector('.modal-header').scrollHeight;
                    const modalFooterEl = modalEl.querySelector('.modal-footer').scrollHeight;
                    const modalBodyEl = modalEl.querySelector('.modal-body');
                    modalBodyEl.style.maxHeight = ('calc(100vh - 4rem - ' + (modalHeaderEl + modalFooterEl) + 'px)');
                })
            });

            modalContent.forEach(el => {
                el.addEventListener('click', (event) => {
                    event.stopPropagation();
                });
            });

            modal.forEach(el => {
                el.addEventListener('click', () => {
                    el.classList.remove('active');
                });
            });

            modalClose.forEach(el => {
                el.addEventListener('click', () => {
                    modal.forEach(el => {
                        el.classList.remove('active');
                    });
                });
            });

            /*
             * Tabs
             */

            const tabs = document.querySelectorAll('.tabs');

            tabs.forEach(el => {
                let nav = el.querySelector('nav');
                let a = nav.querySelectorAll('a');

                a[0].classList.add('active');
                document.getElementById(a[0].getAttribute('href').substring(1)).classList.add('active');

                a.forEach(el => {
                    el.addEventListener('click', (event) => {
                        event.preventDefault();

                        a.forEach(el => {
                            el.classList.remove('active');
                            document.getElementById(el.getAttribute('href').substring(1)).classList.remove('active');
                        });

                        el.classList.add('active');
                        document.getElementById(el.getAttribute('href').substring(1)).classList.add('active');

                    });
                });
            });

            /*
             * Dropdown
             */

            const dropdown = document.querySelectorAll('.dropdown');

            dropdown.forEach(el => {

                const dropdownContent = el.querySelector('.dropdown-content');
                console.log(dropdownContent);

                el.addEventListener('click', (event) => {

                    event.stopPropagation();

                    dropdown.forEach(el => {
                        el.classList.remove('active');
                    });

                    el.classList.add('active');

                    dropdownContent.addEventListener('click', (event) => {
                        event.stopPropagation();
                        dropdownContent.parentElement.classList.remove('active');
                    });

                });

            });

            window.addEventListener('click', () => {
                dropdown.forEach(el => {
                    el.classList.remove('active');
                });
            });

        }
    </script>

</head>

<body>
</body>

</html>